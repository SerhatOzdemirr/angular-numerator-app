<div class="service-management">
  <header>
    <h3>Service Management</h3>
    <button class="btn" (click)="showAddModal()">+ New Service</button>
  </header>

  <div class="table-wrapper">
    <table class="table">
      <thead>
        <tr>
          <th>Key</th>
          <th>Label</th>
          <th>Priority</th>
          <th>Active</th>
          <th>Max #</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let svc of services; trackBy: trackById">
          <td>{{ svc.serviceKey }}</td>
          <td>
            {{ svc.label }}
            <span
              class="prio-badge"
              [class.high]="svc.priority >= 4"
              [class.low]="svc.priority <= 2"
            >
              P{{ svc.priority }}
            </span>
          </td>
          <td>{{ svc.priority }}</td>
          <td>
            <input
              class="active-checkbox"
              type="checkbox"
              [checked]="svc.isActive"
              [disabled]="activeUpdating[svc.id]"
              (change)="onToggleActive(svc, $event)"
            />
          </td>
          <td>{{ svc.maxNumber }}</td>
          <td>
            <button class="btn-sm" (click)="showEditModal(svc)">Edit</button>
            <button class="btn-sm danger" (click)="deleteService(svc)">
              Delete
            </button>
            <button class="btn-sm" (click)="setMaxNumber(svc)">
              Set Max #
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Edit Modal -->
  <div class="modal-backdrop" *ngIf="editModalVisible">
    <div class="modal" id="edit-modal">
      <h4>Edit Service</h4>
      <label>Key:<br /><input [(ngModel)]="updatedKey" /></label>
      <label>Label:<br /><input [(ngModel)]="updatedLabel" /></label>
      <label
        >Max #:<br /><input type="number" [(ngModel)]="updatedMax"
      /></label>
      <label
        >Priority (1-5):<br /><input
          type="number"
          min="1"
          max="5"
          [(ngModel)]="updatedPriority"
      /></label>
      <div class="checbox-div">
        <label
          >Active:<br /><input type="checkbox" [(ngModel)]="updatedActive"
        /></label>
      </div>
      <div class="modal-actions">
        <button class="btn" (click)="saveEdit()">Save</button>
        <button class="btn danger" (click)="cancelEdit()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Add Modal -->
  <div class="modal-backdrop" *ngIf="addModalVisible">
    <div class="modal" id="add-modal">
      <h4>Add Service</h4>
      <label>Key:<br /><input [(ngModel)]="addedKey" /></label>
      <label>Label:<br /><input [(ngModel)]="addedLabel" /></label>
      <label>Max #:<br /><input type="number" [(ngModel)]="addedMax" /></label>
      <label
        >Priority (1-5):<br /><input
          type="number"
          min="1"
          max="5"
          [(ngModel)]="addedPriority"
      /></label>
      <div class="checbox-div">
        <label
          >Active:<br /><input type="checkbox" [(ngModel)]="addedActive"
        /></label>
      </div>
      <div class="modal-actions">
        <button class="btn" (click)="saveAdd()">Save</button>
        <button class="btn danger" (click)="cancelAdd()">Cancel</button>
      </div>
    </div>
  </div>
</div>
