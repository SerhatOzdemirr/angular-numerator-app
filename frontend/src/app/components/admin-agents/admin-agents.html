<div class="admin-agents-container">
  <h2>Create Agent</h2>
  <div class="form-group">
    <input [(ngModel)]="username" placeholder="Username" />
    <input [(ngModel)]="email" placeholder="Email" />
    <input [(ngModel)]="password" placeholder="Password" type="password" />
  </div>

  <div class="dropdown">
    <div
      class="dropdown-toggle services-section"
      data-bs-toggle="dropdown"
      aria-expanded="false"
    >
      Services
    </div>
    <ul
      class="dropdown-menu p-2"
      style="width: 100%; max-height: 200px; overflow-y: auto"
    >
      <li *ngFor="let s of services" class="dropdown-item px-2 py-1">
        <label class="d-flex align-items-center gap-2 m-0">
          <input
            type="checkbox"
            [value]="s.serviceKey"
            (change)="
              onServiceToggle(s.serviceKey, $any($event.target).checked)
            "
          />
          {{ s.label }}
        </label>
      </li>
    </ul>
  </div>

  <button (click)="createAgent()">Create Agent</button>
  <p *ngIf="error" class="error">{{ error }}</p>
  <p *ngIf="success" class="success">{{ success }}</p>

  <hr />

  <h2>Existing Agents</h2>
  <table *ngIf="agents.length">
    <thead>
      <tr>
        <th>ID</th>
        <th>Username</th>
        <th>Email</th>
        <th>Services</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let a of agents">
        <td>{{ a.agentId }}</td>
        <td>{{ a.username }}</td>
        <td>{{ a.email }}</td>
        <td>{{ a.serviceKeys.join(", ") }}</td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="!agents.length">No agents found.</div>
</div>
